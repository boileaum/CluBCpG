

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to CluBCpG’s documentation! &mdash; CluBCpG 0.1.9 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> CluBCpG
          

          
          </a>

          
            
            
              <div class="version">
                0.1.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to CluBCpG’s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">CluBCpG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to CluBCpG’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-clubcpg-s-documentation">
<h1>Welcome to CluBCpG’s documentation!<a class="headerlink" href="#welcome-to-clubcpg-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
<span class="target" id="module-clubcpg.ParseBam"></span><dl class="class">
<dt id="clubcpg.ParseBam.BamFileReadParser">
<em class="property">class </em><code class="descclassname">clubcpg.ParseBam.</code><code class="descname">BamFileReadParser</code><span class="sig-paren">(</span><em>bamfile</em>, <em>quality_score</em>, <em>read1_5=None</em>, <em>read1_3=None</em>, <em>read2_5=None</em>, <em>read2_3=None</em>, <em>no_overlap=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ParseBam.html#BamFileReadParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ParseBam.BamFileReadParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to simplify the opening and reading from BAM files. BAMs must be coordinate sorted and indexed.</p>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">clubcpg.ParseBam</span> <span class="k">import</span> <span class="n">BamFileReadParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">BamFileReadParser</span><span class="p">(</span><span class="s2">&quot;/path/to/data.BAM&quot;</span><span class="p">,</span> <span class="n">quality_score</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reads</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_reads</span><span class="p">(</span><span class="s2">&quot;chr7&quot;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">101000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">create_matrix</span><span class="p">(</span><span class="n">reads</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="clubcpg.ParseBam.BamFileReadParser.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>bamfile</em>, <em>quality_score</em>, <em>read1_5=None</em>, <em>read1_3=None</em>, <em>read2_5=None</em>, <em>read2_3=None</em>, <em>no_overlap=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ParseBam.html#BamFileReadParser.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ParseBam.BamFileReadParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Class used to read WGBSeq reads from a BAM file, extract methylation, and convert into data frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bamfile</strong> – Path to bam file location</p></li>
<li><p><strong>quality_score</strong> – Only include reads &gt;= this fastq quality</p></li>
<li><p><strong>read1_5</strong> – mbias ignore read1 5’</p></li>
<li><p><strong>read1_3</strong> – mbias ignore read1 3’</p></li>
<li><p><strong>read2_5</strong> – mbias ignore read2 5’</p></li>
<li><p><strong>read2_3</strong> – mbias ignore read2 3’</p></li>
<li><p><strong>no_overlap</strong> – bool. If overlap exists between two reads, ignore that region from read 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ParseBam.BamFileReadParser.create_matrix">
<code class="descname">create_matrix</code><span class="sig-paren">(</span><em>read_cpgs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ParseBam.html#BamFileReadParser.create_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ParseBam.BamFileReadParser.create_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Converted parsed reads into a pandas dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>read_cpgs</strong> (<em>iterable</em>) – read CpGs generated by self.parse_reads</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix methylated (1) and unmethylated (0) states</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ParseBam.BamFileReadParser.fix_read_overlap">
<code class="descname">fix_read_overlap</code><span class="sig-paren">(</span><em>full_reads</em>, <em>read_cpgs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ParseBam.html#BamFileReadParser.fix_read_overlap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ParseBam.BamFileReadParser.fix_read_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes pysam reads and read_cpgs generated during parse reads and removes any
overlap between read1 and read2. If possible it also stitches read1 and read2 together to create
a super read.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_reads</strong> – set of reads generated by self.parse_reads()</p></li>
<li><p><strong>read_cpgs</strong> – todoo</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list in the same format as read_cpgs input, but corrected for paired read overlap</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ParseBam.BamFileReadParser.parse_reads">
<code class="descname">parse_reads</code><span class="sig-paren">(</span><em>chromosome: str</em>, <em>start: int</em>, <em>stop: int</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ParseBam.html#BamFileReadParser.parse_reads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ParseBam.BamFileReadParser.parse_reads" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chromosome</strong> – chromosome as “chr6”</p></li>
<li><p><strong>start</strong> – start coordinate</p></li>
<li><p><strong>stop</strong> – end coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of reads and their positional tags as assigned by bismark</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-clubcpg.ClusterReads"></span><dl class="class">
<dt id="clubcpg.ClusterReads.ClusterReads">
<em class="property">class </em><code class="descclassname">clubcpg.ClusterReads.</code><code class="descname">ClusterReads</code><span class="sig-paren">(</span><em>bam_a: str</em>, <em>bam_b=None</em>, <em>bin_size=100</em>, <em>bins_file=None</em>, <em>output_directory=None</em>, <em>num_processors=1</em>, <em>cluster_member_min=4</em>, <em>read_depth_req=10</em>, <em>remove_noise=True</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>suffix=''</em>, <em>no_overlap=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ClusterReads.html#ClusterReads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ClusterReads.ClusterReads" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to take a dataframe or matrix of reads and cluster them</p>
<dl class="method">
<dt id="clubcpg.ClusterReads.ClusterReads.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>bam_a: str</em>, <em>bam_b=None</em>, <em>bin_size=100</em>, <em>bins_file=None</em>, <em>output_directory=None</em>, <em>num_processors=1</em>, <em>cluster_member_min=4</em>, <em>read_depth_req=10</em>, <em>remove_noise=True</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>suffix=''</em>, <em>no_overlap=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ClusterReads.html#ClusterReads.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ClusterReads.ClusterReads.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ClusterReads.ClusterReads.process_bins">
<code class="descname">process_bins</code><span class="sig-paren">(</span><em>bin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ClusterReads.html#ClusterReads.process_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ClusterReads.ClusterReads.process_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main method and should be called using Pool.map It takes one bin location and uses the other helper
functions to get the reads, form the matrix, cluster it with DBSCAN, and output the cluster data as text lines
ready to writing to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bin</strong> – string in this format: “chr19_55555”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of lines representing the cluster data from that bin</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="clubcpg.ClusterReads.ClusterReadsWithImputation">
<em class="property">class </em><code class="descclassname">clubcpg.ClusterReads.</code><code class="descname">ClusterReadsWithImputation</code><span class="sig-paren">(</span><em>bam_a: str</em>, <em>bam_b=None</em>, <em>bin_size=100</em>, <em>bins_file=None</em>, <em>output_directory=None</em>, <em>num_processors=1</em>, <em>cluster_member_min=4</em>, <em>read_depth_req=10</em>, <em>remove_noise=True</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>suffix=''</em>, <em>no_overlap=True</em>, <em>models_A=None</em>, <em>models_B=None</em>, <em>chunksize=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ClusterReads.html#ClusterReadsWithImputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ClusterReads.ClusterReadsWithImputation" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is used to perfom the same clustering, but also enabled the ability to perform imputation during clustering.
This inherits from <a class="reference internal" href="#clubcpg.ClusterReads.ClusterReads" title="clubcpg.ClusterReads.ClusterReads"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClusterReads</span></code></a></p>
<dl class="method">
<dt id="clubcpg.ClusterReads.ClusterReadsWithImputation.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>bam_a: str</em>, <em>bam_b=None</em>, <em>bin_size=100</em>, <em>bins_file=None</em>, <em>output_directory=None</em>, <em>num_processors=1</em>, <em>cluster_member_min=4</em>, <em>read_depth_req=10</em>, <em>remove_noise=True</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>suffix=''</em>, <em>no_overlap=True</em>, <em>models_A=None</em>, <em>models_B=None</em>, <em>chunksize=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ClusterReads.html#ClusterReadsWithImputation.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ClusterReads.ClusterReadsWithImputation.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-clubcpg.ConnectToCpGNet"></span><dl class="class">
<dt id="clubcpg.ConnectToCpGNet.ImputeWithCpGNet">
<em class="property">class </em><code class="descclassname">clubcpg.ConnectToCpGNet.</code><code class="descname">ImputeWithCpGNet</code><span class="sig-paren">(</span><em>cpg_density: int</em>, <em>bin: str</em>, <em>bin_size=100</em>, <em>path_to_models=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#ImputeWithCpGNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.ImputeWithCpGNet" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED: Please do not use this class.
Class used to connect parts of clubcpg to the CpGNet package)</p>
<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.ImputeWithCpGNet.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>cpg_density: int</em>, <em>bin: str</em>, <em>bin_size=100</em>, <em>path_to_models=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#ImputeWithCpGNet.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.ImputeWithCpGNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Class used to connect this package with CpGNet’s imputation classes</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>cpg_density {int} – number of CpGs in bin
bin {str} – bin in format “chr1_4444”</p>
</dd>
<dt>Keyword Arguments:</dt><dd><p>bin_size {int} – size of bin in base-pairs (default: {100})
path_to_models {[str]} – Path to directory containing models built by TrainModels scripy (default: {None})</p>
</dd>
<dt>Raises:</dt><dd><p>AttributeError – Raised if a path to the models directory is not specified or does not exist</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.ImputeWithCpGNet.get_model">
<code class="descname">get_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#ImputeWithCpGNet.get_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.ImputeWithCpGNet.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Called during init to load model from disk into instance object</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>[type] – CpGNet model</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.ImputeWithCpGNet.impute_matrix">
<code class="descname">impute_matrix</code><span class="sig-paren">(</span><em>matrix</em>, <em>postprocess=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#ImputeWithCpGNet.impute_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.ImputeWithCpGNet.impute_matrix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> – 2D np array with unknowns as -1</p></li>
<li><p><strong>positions</strong> – 1D np array of chromosomal positions (ints)</p></li>
<li><p><strong>postprocess</strong> – Imply classes from imputation, if False, returns probabilities instead of predictions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matrix imputed with highly confident predictions, less confident regions are assigned np.nan</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.ImputeWithCpGNet.postprocess">
<code class="descname">postprocess</code><span class="sig-paren">(</span><em>predicted_matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#ImputeWithCpGNet.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.ImputeWithCpGNet.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes array with predicted values and rounds them to 0 or 1 if threshold is exceeded</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>predicted_matrix {[type]} – matrix generated by imputation</p>
</dd>
<dt>Returns:</dt><dd><p>[type] – predicted matrix predictions as 1, 0, or NaN</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="clubcpg.ConnectToCpGNet.TrainWithCpGNet">
<em class="property">class </em><code class="descclassname">clubcpg.ConnectToCpGNet.</code><code class="descname">TrainWithCpGNet</code><span class="sig-paren">(</span><em>cpg_density=None</em>, <em>save_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#TrainWithCpGNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.TrainWithCpGNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to train models using CpGnet</p>
<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.TrainWithCpGNet.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>cpg_density=None</em>, <em>save_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#TrainWithCpGNet.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.TrainWithCpGNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to train a CpGNet model from input data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpg_density</strong> – Number of CpGs</p></li>
<li><p><strong>save_path</strong> – Location of folder to save the resulting model files. One per cpg density</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.TrainWithCpGNet.save_net">
<code class="descname">save_net</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#TrainWithCpGNet.save_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.TrainWithCpGNet.save_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the network to a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – The trained CpGNet model. Located at CpGNet.model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Path to the saved model</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.ConnectToCpGNet.TrainWithCpGNet.train_model">
<code class="descname">train_model</code><span class="sig-paren">(</span><em>bins: iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/ConnectToCpGNet.html#TrainWithCpGNet.train_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.ConnectToCpGNet.TrainWithCpGNet.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the CpGNet model on a list of provided bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bins</strong> – iterable containing CpG matrices of 1 (methylated), 0 (unmethylated), and -1 (unknown)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Path to the saved model file</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-clubcpg.Imputation"></span><dl class="class">
<dt id="clubcpg.Imputation.Imputation">
<em class="property">class </em><code class="descclassname">clubcpg.Imputation.</code><code class="descname">Imputation</code><span class="sig-paren">(</span><em>cpg_density: int</em>, <em>bam_file: str</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>processes=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation" title="Permalink to this definition">¶</a></dt>
<dd><p>The class providing convienent APIs to train models and impute from models using CpGNet</p>
<dl class="method">
<dt id="clubcpg.Imputation.Imputation.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>cpg_density: int</em>, <em>bam_file: str</em>, <em>mbias_read1_5=None</em>, <em>mbias_read1_3=None</em>, <em>mbias_read2_5=None</em>, <em>mbias_read2_3=None</em>, <em>processes=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>cpg_density {int} – Number of CpGs this class instance will be used for
bam_file {str} – path to the bam file</p>
</dd>
<dt>Keyword Arguments:</dt><dd><p>mbias_read1_5 {[type]} – [description] (default: {None})
mbias_read1_3 {[type]} – [description] (default: {None})
mbias_read2_5 {[type]} – [description] (default: {None})
mbias_read2_3 {[type]} – [description] (default: {None})
processes {int} – number or CPUs to use when parallelization can be utilized, default= All available (default: {-1})</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.Imputation.Imputation.extract_matrices">
<code class="descname">extract_matrices</code><span class="sig-paren">(</span><em>coverage_data_frame: pandas.core.frame.DataFrame</em>, <em>sample_limit: int = None</em>, <em>return_bins=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation.extract_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation.extract_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract CpG matrices from bam file.</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>coverage_data_frame {pd.DataFrame} – Output of CalculateBinCoverage read in as a csv file</p>
</dd>
<dt>Keyword Arguments:</dt><dd><p>return_bins {bool} – Return the bin location along with the matrix (default: {False})</p>
</dd>
<dt>Returns:</dt><dd><p>[tuple] – Returns tuple of (bin, np.array) if returns_bins = True else returns only np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.Imputation.Imputation.impute_from_model">
<code class="descname">impute_from_model</code><span class="sig-paren">(</span><em>models_folder: str</em>, <em>matrices: iter</em>, <em>postprocess=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation.impute_from_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation.impute_from_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator to provide imputed matrices on-the-fly</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>models_folder {str} – Path to directory containing trained CpGNet models
matrices {iter} – An iterable containging n x m matrices with n=cpgs and m=reads</p>
</dd>
<dt>Keyword Arguments:</dt><dd><p>postprocess {bool} – Round imputed values to 1s and 0s  (default: {True})</p>
</dd>
</dl>
</dd></dl>

<dl class="staticmethod">
<dt id="clubcpg.Imputation.Imputation.postprocess_predictions">
<em class="property">static </em><code class="descname">postprocess_predictions</code><span class="sig-paren">(</span><em>predicted_matrix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation.postprocess_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation.postprocess_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes array with predicted values and rounds them to 0 or 1 if threshold is exceeded</p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>predicted_matrix {[type]} – matrix generated by imputation</p>
</dd>
<dt>Returns:</dt><dd><p>[type] – predicted matrix predictions as 1, 0, or NaN</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="clubcpg.Imputation.Imputation.train_model">
<code class="descname">train_model</code><span class="sig-paren">(</span><em>output_folder: str</em>, <em>matrices: iter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/clubcpg/Imputation.html#Imputation.train_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#clubcpg.Imputation.Imputation.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a CpGNet model using <a class="reference internal" href="#clubcpg.ConnectToCpGNet.TrainWithCpGNet" title="clubcpg.ConnectToCpGNet.TrainWithCpGNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainWithCpGNet</span></code></a></p>
<dl class="simple">
<dt>Arguments:</dt><dd><p>output_folder {str} – Folder to save trained models
matrices {iter} – An iterable of CpGMatrices - ideally obtained through Imputation.extract_matrices()</p>
</dd>
<dt>Returns:</dt><dd><p>[keras model] – Returns the trained CpGNet model</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anthony Scott, PhD

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>